<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="keywords" content="hexo,个人博客,blog" />
  <meta name="description" content="邓子乐的札记" />
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <link rel="dns-prefetch" href="https://busuanzi.ibruce.info">
  <link rel="dns-prefetch" href="https://at.alicdn.com">
  
  <link rel="dns-prefetch" href="https://widget.daovoice.io">
  <link rel="dns-prefetch" href="https://widget-static-cdn.daovoice.io">
  <link rel="dns-prefetch" href="https://im.daovoice.io">
  
  
  
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://api.github.com">
  <link rel="dns-prefetch" href="https://avatars3.githubusercontent.com">
  
  <link rel="stylesheet" type="text/css" href="/./style/main.css">
	<link rel="shortcut icon" href="/favicon.ico" title="Favicon">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
	<title>RSA学习小记</title>
  
  
    <script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/249019c1.js","daovoice");daovoice('init',{app_id: "249019c1"});daovoice('update');
  </script>
  
<meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="邓子乐的札记" type="application/atom+xml">
</head>
<body>
  <canvas id="pattern-placeholder" height="230"></canvas>
<div class="navbar-header">
  <a class="blog-title" href="/">邓子乐的札记</a>
  <a class="face-img" href="/">
    <img src="https://tva3.sinaimg.cn/crop.0.0.272.272.180/6824447fgw1eacrzhabwbj207l07lweu.jpg">
  </a>
</div>
<main>
  <div class="article-title">
    
  
  <h1 class="title">
    RSA学习小记
  </h1>
  


    <ul class="article-info">
      <li>
        发布
        <time datetime="2019-12-22T08:13:41.000Z" itemprop="datePublished">2019-12-22</time>
      </li>
      <li>
        
    更新 <time datetime="2020-11-08T02:13:05.504Z" itemprop="dateUpdated">2020-11-08</time>

      </li>
      <li id="busuanzi_container_page_pv">
        阅读 <span id="busuanzi_value_page_pv"></span>
      </li>
    </ul>
  </div>
  <div class="container">
    <div class="article">
      <div class="content">
        
        <div class="overdue-remind">
          本文最后更新于$day天前，文中所描述的信息可能已发生改变。
        </div>
        
        <p>一路以来，接触最多的算法是MD5,SHA1。</p>
<p>或者AES等对称加密。对RSA的加密方式比较少接触。</p>
<p>最近在研究一个算法，需要用到RSA，我发现，使用起来，并没有那么简单。</p>
<blockquote>
<p>RSA公开密钥密码体制。所谓的公开密钥密码体制就是使用不同的加密密钥与解密密钥，是一种“由已知加密密钥推导出解密密钥在计算上是不可行的”密码体制。</p>
</blockquote>
<h2 id="第一、我以前对密钥的理解更新了新的知识"><a href="#第一、我以前对密钥的理解更新了新的知识" class="headerlink" title="第一、我以前对密钥的理解更新了新的知识"></a>第一、我以前对密钥的理解更新了新的知识</h2><p>以我之前的理解，<strong>RSA算法，需要公钥和私钥，公钥加密、私钥解密。</strong></p>
<p>如果需要反过来，那可以把密钥调换，即可做到互相接收密钥的作用。外部消息通过公钥加密，传输过来，本地使用私钥解密，即可防止中间人攻击，让他们无法修改消息。</p>
<p>如果需要互相传递消息，我们只需要两对密钥，并互相交换即可。</p>
<p>昨天我才知道，<strong>原来公钥，是可以通过私钥推理出来</strong>。那么私钥其实就成为了整个非常重要的钥匙，是很难进行交换的。</p>
<blockquote>
<p>第一种用法：公钥加密，私钥解密。—用于加解密</p>
<p>第二种用法：私钥签名，公钥验签。—用于签名</p>
</blockquote>
<p>如果数字证书，按照公钥加密，私钥解密，那么就不可能了，所以原来证书，是反过来的。我们所有电脑都有公钥，用于验证对方计算机签发证书是否正确，而私钥只能储存在证书签发机构。这样才能确保证书的签发安全。</p>
<h2 id="第二、RSA算法、填充方法、也分很多种。"><a href="#第二、RSA算法、填充方法、也分很多种。" class="headerlink" title="第二、RSA算法、填充方法、也分很多种。"></a>第二、RSA算法、填充方法、也分很多种。</h2><blockquote>
<p>非对称算法，常用有RSA、RSA2、国密算法、 ECDSA - 支付宝开放平台提供的加密方式</p>
</blockquote>
<p>①、我们常用的只有：RSA</p>
<p>②、密钥长度常用是：1024、2048</p>
<p>③、填充方式：常用是 PKCS1 Java常用是PKCS8</p>
<p><img src="https://dengzile.com/wp-content/uploads/2019/12/image-7.png"></p>
<p>PKCS的常用方式</p>
<h2 id="第三、公钥、私钥的存在形式"><a href="#第三、公钥、私钥的存在形式" class="headerlink" title="第三、公钥、私钥的存在形式"></a>第三、公钥、私钥的存在形式</h2><p>密钥存在形式有已Base64形式存在、二进制HEX形式存在、XML形式存在，证书形式存在</p>
<p>一看，蒙圈了，连证书方式也有那么多种。</p>
<p>①、证书形式和Base64形式其实是一致的，他们可以方便互相转换。证书形式就是多了一个 —–BEGIN PUBLIC KEY—– 形式，介绍这个证书是私钥、公钥还是有密码的私钥。以下提供一个PHP从Base64形式转换成公私钥的代码，原理就是每64位换行</p>
<p> $publicKey = ‘公钥’;<br> $privateKey = ‘私钥’;<br> $pubPem = chunk_split($publicKey,64,”\n”);<br> $pubPem = “—–BEGIN PUBLIC KEY—–\n” . $pubPem . “—–END PUBLIC KEY—–\n”;<br> print_r($pubPem);<br> // 验证公钥格式是否正确<br> $pu_key = openssl_pkey_get_public($pubPem);<br> if (!$pu_key) die(‘$pu_key 格式不正确’);<br> $priPem = chunk_split($privateKey,64,”\n”);<br> $priPem = “—–BEGIN PRIVATE KEY—–\n” . $priPem . “—–END PRIVATE KEY—–\n”;</p>
<blockquote>
<p>代码引用-&gt; <a target="_blank" rel="noopener" href="https://199508.com/post/2052">https://199508.com/post/2052</a></p>
</blockquote>
<p>PHP代码有chunk_split 函数，方便切割。</p>
<p>②、XML形式XML形式主要是C#使用函数FromXmlString 加载密钥使用，公钥存在Modulus中，私钥分为很多形式，我用图片说明。</p>
<p><img src="https://dengzile.com/wp-content/uploads/2019/12/image-8-1024x308.png"></p>
<p>红色圈的都是C#里面XMLFile的私钥</p>
<p>你必须对私钥、RSA算法理解清楚才知道每个参数作用。兼职灭绝人性，怎么那么不通用呢。</p>
<p>③、二进制形式，由于C#里面都使用Byte[]来存储各个参数而不是Base64代码，所以我们通常是直接把Byte[]转换成Hex进行储存。</p>
<p>RSA rsa = RSA.Create()<br> rsa.ImportParameters(new RSAParameters() { Exponent = “010001”.ToByteArray(16, 2), Modulus = RsaKey.ToByteArray(16, 2) });<br> //ToByteArray 函数为 引用：System.Extended.dll<br> //程序集 System.Extended, Version=3.4.16.616, Culture=neutral, PublicKeyToken=675fb48d7a2b2d96<br> //用意是把String已16禁止转换成Byte[]<br> //或使用我反编译代码<br> public static byte[] ToByteArray(this string value, int radix, int width)<br> {<br>     List list = new List();<br>     for (int i = 0; i &lt; value.Length; i += width)     {         byte? b = (i + width &gt; value.Length) ? value.Substring(i, value.Length - i).ToByte(radix) : value.Substring(i, width).ToByte(radix);<br>         if (!b.HasValue)<br>         {<br>             return null;<br>         }<br>         list.Add(b.Value);<br>     }<br>     return list.ToArray();<br> }</p>
<p>④、由于他们存在形式太多，如果我们使用在服务器、软件、网页上的证书还有包含信息的证书：CSR、PEM、PFX、JKS、P7B、CRT、CER。</p>
<p>在SSL版本、协议上更为复杂。我们在这里不过多研究。记录下几个常用在线网站及一个C# RSA库，可以方便转换PEM文件导入导出密钥使用。</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.myssl.cn/tools">https://www.myssl.cn/tools</a> - 一个SSL在线工具</p>
<p><a target="_blank" rel="noopener" href="https://myssl.com/csr/_create.html">https://myssl.com/csr\_create.html</a> –也是一个SSL在线辅助工具</p>
<p><a target="_blank" rel="noopener" href="http://tool.chacuo.net/cryptrsapubkey">http://tool.chacuo.net/cryptrsapubkey</a> – 一个在线加解密工具</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yyl8781697/archive/2013/04/28/RSA.html">https://www.cnblogs.com/yyl8781697/archive/2013/04/28/RSA.html</a></p>
<p>整合一个基于c#的RSA私钥加密公钥解密的Helper类,含源码</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xiangyuecn/p/9922325.html">https://www.cnblogs.com/xiangyuecn/p/9922325.html</a></p>
<p>C#的RSA加密解密签名，就为了支持PEM PKCS#8格式密钥对的导入导出</p>
</blockquote>
<h2 id="第四、小结"><a href="#第四、小结" class="headerlink" title="第四、小结"></a>第四、小结</h2><p>在现在中间人攻击猖獗时代，量子计算机还没大规模应用，我们只能使用不同加密手段去保护信息安全，防止泄密、监听、拦截。非对称加密只是其中一种。我们在看酸酸乳软件里面，还有更多复杂而厉害的加密、混淆、欺骗的方式。</p>
<p>而一个RSA算法，用不同密钥形式、不同填充方式、不同密钥长度，参数只要错了一个，就无法使用。导致破解算法和协议时，不仅需要对汇编和动态调试了解，还需要对整个加密体系非常了解，在android的调用方式也需要了解，否则将无法还原加密。</p>
<p>最后，分享多一份C# 使用 私钥 RSA,SHA256,签名的代码，虽然没有验签代码，应该也是一个例子。</p>
<p><img src="https://dengzile.com/wp-content/uploads/2019/12/image-9-1024x487.png"></p>

      </div>
        <div class="support-author">
          <p>感谢您的阅读。 🙏
          <a href="https://dengzile.com/" target="_blank">关于转载请看这里</a>
            <!--<a class="btn-pay"  href="#pay-modal">¥ 打赏支持</a>-->
          </p>
        </div>
        <!--
            <div class="like ">
              <div class="like-button">
                <a id="like-note" href="">
                  <i class="icon-heart"></i>喜欢
                </a>
              </div>
              <span id="likes-count">256</span>
            </div>
        -->
        <div class="otherLink">
          <div class="previous">
          </div>
          <div class="next">
          </div>
        </div>
        <div class="comments" id="comments">
          
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script type="text/javascript">
  const gitalk = new Gitalk({
    clientID: '8888a8888',
    clientSecret: '8888886666666',
    repo: 'xxxx.github.io',
    owner: 'admin',
    admin: ['admin'],
    id: location.pathname,      // Ensure uniqueness and length less than 50
    distractionFreeMode: false
  })

  gitalk.render('comments');
</script>


        </div>
      </div>
    </div>
   </div>
</main>
<div class="footer">
  <div class="info">
    <p>
    <a target="_blank" rel="noopener" href="https://hexo.io"> Hexo </a> 强力驱动 |
      <a target="_blank" rel="noopener" href="https://github.com/Youthink/hexo-themes-yearn"> Yearn </a>
      主题
    </p>
    <p>&copy;2013-2021 © 2021 邓子乐的札记   粤ICP备17119090号-1</p>
  </div>
</div>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script>//console
  var consoleConfig = '\n欢迎访问 https://hufangyun.com ，围观小猿大圣的博客(づ｡◕‿‿◕｡)づ！\n,\n本博客使用 %cHexo%c 搭建，博客主题为小猿大圣开发的 %chexo-themes-yearn%c ~~~ 🎉🎉🎉 \n\n源码 https://github.com/Youthink/hexo-themes-yearn \n\n如果喜欢可以 star 支持一下 ❤️~\n,\n扫描下面的二维码，在手机上查看博客！\n,https://static.hufangyun.com/blog-url-qrcode-180-180.png,\n 想知道这个效果如何实现的？博客内搜索 console 彩蛋 🚀 ！\n'.split(',');
  var canConsole = false;
  var consoleInfo = (function(consoleConfig) {
  if (!canConsole || !consoleConfig || consoleConfig.length < 1) {
    return;
  }
  var consoleColor = '#6190e8';
  var _console;
  var backgroundTextStyle = 'padding: 1px 5px;color: #fff;background: ' + consoleColor + ';'
  var textStyle = 'color: ' + consoleColor + ';';

  consoleConfig.map(o => {
    var num = (o.match(/%c/g) || []).length;
    if(/^http(s)?:\/\//.test(o)) {
      console.log('%c     ', 'background: url(' + o + ') no-repeat left center;font-size: 180px;');
      return;
    }
    if (num > 0) {
      var logArguments = [];
      for (var i = 0; i < num; i++) {
        if (i % 2 === 0) {
          logArguments.push(backgroundTextStyle);
        } else {
          logArguments.push(textStyle);
        }
      }
      (_console = console).log.apply(_console, ['%c' + o, textStyle].concat(logArguments));
      return;
    }
    console.log('%c' + o, textStyle);
  });
}(consoleConfig));</script><script type="text/javascript" src="/./js/main.js"></script>

  <script src="//at.alicdn.com/t/font_159214_mvtxvg9me9.js"></script>
</body>
</html>
